# ***************************************************************
# 
#   file:  Makefile
#   desc:  Makefile for CoreDX DDS example Hello World applications
#  
# ***************************************************************
# 
#    Coypright(C) 2006-2011 Twin Oaks Computing, Inc
#    All rights reserved.   Castle Rock, CO 80108
# 
# ****************************************************************
# 
#   This file is provided by Twin Oaks Computing, Inc
#   as an example. It is provided in the hope that it will be 
#   useful but WITHOUT ANY WARRANTY; without even the implied 
#   warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR 
#   PURPOSE. TOC Inc assumes no liability or responsibilty for 
#   the use of this information for any purpose.
#   
# ***************************************************************/

##########################################################
#
# This Makefile uses the following environment variables:
#  COREDX_TOP
#  COREDX_HOST
#  COREDX_TARGET
# These variables can be set manually, or determined by
# running the script  scripts/cdxenv.sh or scripts\cdxenv.bat
#
##########################################################

# Define our sources and objects
EXECUTABLE      = hello_pub.exe hello_sub.exe

##########################################################
# Setup Compile Environment
# We assume the approriate C# compiler (csc.exe) is in your path
CS         = csc
DDL        = $(COREDX_TOP)\host\$(COREDX_HOST)\bin\coredx_ddl
LIB_PATH   = -L$(COREDX_TOP)\target\$(COREDX_TARGET)\lib


GEN_CODE   = StringMsg.cs StringMsgTypeSupport.cs StringMsgDataReader.cs StringMsgDataWriter.cs
LIBS       = coredx_csharp.dll dds_csharp.dll

##########################################################
# Rules for compiling

all: $(EXECUTABLE)

hello_pub.exe: hello_pub.cs hello.ddl $(LIBS)
	$(DDL) -l csharp -f hello.ddl
	$(CS) hello_pub.cs $(GEN_CODE) /r:coredx_csharp.dll

hello_sub.exe: hello_sub.cs hello.ddl $(LIBS)
	$(DDL) -l csharp -f hello.ddl
	$(CS) hello_sub.cs $(GEN_CODE) /r:coredx_csharp.dll

coredx_csharp.dll: $(COREDX_TOP)\target\$(COREDX_TARGET)\lib\coredx_csharp.dll
	copy $(COREDX_TOP)\target\$(COREDX_TARGET)\lib\coredx_csharp.dll .

dds_csharp.dll: $(COREDX_TOP)\target\$(COREDX_TARGET)\lib\dds_csharp.dll
	copy $(COREDX_TOP)\target\$(COREDX_TARGET)\lib\dds_csharp.dll .

##########################################################
# Rules for cleaning

clean:
	del $(EXECUTABLE)

reallyclean: clean
	del $(GEN_CODE) $(LIBS)
